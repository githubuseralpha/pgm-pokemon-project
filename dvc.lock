schema: '2.0'
stages:
  prepare_data:
    cmd: python src/dataset.py --prepare --target-folder data/images --seed 42
    deps:
    - path: src/dataset.py
      hash: md5
      md5: 4c25246177058b2bacb0f2d5ced60da0
      size: 6823
    outs:
    - path: data/images/test
      hash: md5
      md5: 057c8c400e565ea232e27294202c9373.dir
      size: 6226864
      nfiles: 251
    - path: data/images/train
      hash: md5
      md5: 21f412e86b5ca4bddd29b216bf600a0e.dir
      size: 48486750
      nfiles: 2002
    - path: data/images/val
      hash: md5
      md5: 235eb2ab2d9f65da1cf479413c030b57.dir
      size: 6242962
      nfiles: 250
  train_gan:
    cmd: python src/train_gan.py --dataroot data/images --config params.yaml
    deps:
    - path: data/images/train
      hash: md5
      md5: 21f412e86b5ca4bddd29b216bf600a0e.dir
      size: 48486750
      nfiles: 2002
    - path: data/images/val
      hash: md5
      md5: 235eb2ab2d9f65da1cf479413c030b57.dir
      size: 6242962
      nfiles: 250
    - path: params.yaml
      hash: md5
      md5: d960da2b9a8737a480ae1f8d7235f893
      size: 1258
    - path: src/gan_dataset.py
      hash: md5
      md5: bc07ee8352c6ab44a9dbbae91a16cc77
      size: 3057
    - path: src/gan_models.py
      hash: md5
      md5: 03488f78ab4bd096edd07faca18b3a6e
      size: 2939
    - path: src/train_gan.py
      hash: md5
      md5: 19d3b6b24aa7e3e25edc364cf65822d7
      size: 10257
    - path: src/unified_metrics.py
      hash: md5
      md5: 7c5b7e7bc6bb9b8c793a25e2cf6ad5db
      size: 7294
    params:
      params.yaml:
        gan:
          workers: 4
          batch_size: 128
          image_size: 128
          nc: 3
          nz: 100
          ngf: 128
          ndf: 64
          num_epochs: 250
          lr: 0.0002
          beta1: 0.5
          wandb_project: pokemon-gan
          wandb_run_name: gan-training
          seed: 42
    outs:
    - path: models/gan_discriminator.pth
      hash: md5
      md5: 837de5a7577a6b113637a0967922e7c5
      size: 11204276
    - path: models/gan_generator.pth
      hash: md5
      md5: a779e9d84d9ecdcad655d769fe983fea
      size: 51710155
    - path: results/gan_metrics.json
      hash: md5
      md5: 915f3f535b38a463615f7cabfa220e66
      size: 170
  train_diffusion:
    cmd: python src/train_diff_models.py --dataroot data/images --config params.yaml
    deps:
    - path: data/images/train
      hash: md5
      md5: 21f412e86b5ca4bddd29b216bf600a0e.dir
      size: 48486750
      nfiles: 2002
    - path: data/images/val
      hash: md5
      md5: 235eb2ab2d9f65da1cf479413c030b57.dir
      size: 6242962
      nfiles: 250
    - path: params.yaml
      hash: md5
      md5: d960da2b9a8737a480ae1f8d7235f893
      size: 1258
    - path: src/dataset.py
      hash: md5
      md5: 4c25246177058b2bacb0f2d5ced60da0
      size: 6823
    - path: src/diff_models.py
      hash: md5
      md5: 0101b88a59ea2b49f3e9bba570f9877c
      size: 18695
    - path: src/train_diff_models.py
      hash: md5
      md5: 710c1fc00ac6c065fb6574be65bc344f
      size: 8887
    - path: src/unified_metrics.py
      hash: md5
      md5: 7c5b7e7bc6bb9b8c793a25e2cf6ad5db
      size: 7294
    - path: src/visuals.py
      hash: md5
      md5: 4add5c77cce8528267b2e976cf5972a3
      size: 3543
    params:
      params.yaml:
        diffusion:
          batch_size: 16
          num_workers: 6
          epochs: 50
          lr: 0.0001
          num_timesteps: 1000
          image_size: 128
          save_interval: 10
          sample_batch_size: 48
          channels:
          - 64
          - 128
          - 256
          - 512
          - 1024
          layers_per_block: 2
          downblock: ResnetDownsampleBlock2D
          upblock: ResnetUpsampleBlock2D
          add_attention: true
          attention_head_dim: 64
          checkpoint_dir: checkpoints_diffusion
          output_dir: output_diffusion
          wandb_project: pokemon-diffusion
          wandb_run_name: ddpm-training
          seed: 42
    outs:
    - path: checkpoints_diffusion/
      hash: md5
      md5: fe5c18a7c20a512848cea9f529436044.dir
      size: 5761909876
      nfiles: 6
    - path: output_diffusion/
      hash: md5
      md5: cc1c23fec0d5e92ea22f20b9260fc05c.dir
      size: 9188467
      nfiles: 98
    - path: results/diffusion_metrics.json
      hash: md5
      md5: ee463f87fb1acfdb35a929b46f683056
      size: 195
  evaluate_models:
    cmd: python src/evaluate_model.py --gan-model models/gan_generator.pth --diffusion-model
      checkpoints_diffusion/best_model.pt --config params.yaml
    deps:
    - path: checkpoints_diffusion/best_model.pt
      hash: md5
      md5: e7c9812087ec863029a4b663b1138149
      size: 960316886
    - path: data/images/test
      hash: md5
      md5: 057c8c400e565ea232e27294202c9373.dir
      size: 6226864
      nfiles: 251
    - path: models/gan_generator.pth
      hash: md5
      md5: a779e9d84d9ecdcad655d769fe983fea
      size: 51710155
    - path: params.yaml
      hash: md5
      md5: d960da2b9a8737a480ae1f8d7235f893
      size: 1258
    - path: src/evaluate_model.py
      hash: md5
      md5: 79ed792b26fcede58765b6e2fa95fb0e
      size: 7438
    outs:
    - path: results/comparison_metrics.json
      hash: md5
      md5: ec54e4e24095897b30a3b914d9f66ba9
      size: 304
